2025-01-24 16:30:41,738 - Starting final experiment with config: {'data_dir': 'data', 'batch_size': 128, 'num_workers': 4, 'k_dim': 1024, 'z_dim': 256, 'beta': 0.25, 'learning_rate': 0.0002, 'num_epochs': 100, 'device': 'cuda'}
2025-01-24 16:30:41,739 - Using device: cuda
2025-01-24 16:30:58,389 - 
Epoch 1/100
2025-01-24 16:30:58,389 - Train Metrics: {'loss': 0.10000975233743258, 'recon_loss': 0.043308907438574545, 'codebook_loss': 0.045360675777125235, 'commitment_loss': 0.045360675777125235, 'perplexity': 17.951601691867996}
2025-01-24 16:30:58,389 - Test Metrics: {'test_loss': 0.105308450003968, 'test_recon_loss': 0.02990813822120051, 'test_codebook_loss': 0.060320249416782885, 'test_commitment_loss': 0.060320249416782885, 'test_perplexity': 20.929456614240816}
2025-01-24 16:30:58,432 - New best perplexity: 17.951601691867996
2025-01-24 16:31:13,058 - 
Epoch 2/100
2025-01-24 16:31:13,059 - Train Metrics: {'loss': 0.11146633786237453, 'recon_loss': 0.02723337953333812, 'codebook_loss': 0.06738636616969962, 'commitment_loss': 0.06738636616969962, 'perplexity': 22.62978249864505}
2025-01-24 16:31:13,059 - Test Metrics: {'test_loss': 0.10790221657179579, 'test_recon_loss': 0.025853974956877624, 'test_codebook_loss': 0.06563859258460093, 'test_commitment_loss': 0.06563859258460093, 'test_perplexity': 25.417231668399857}
2025-01-24 16:31:13,080 - New best perplexity: 22.62978249864505
2025-01-24 16:31:27,609 - 
Epoch 3/100
2025-01-24 16:31:27,609 - Train Metrics: {'loss': 0.11186815340957983, 'recon_loss': 0.02405368118925625, 'codebook_loss': 0.07025157701214561, 'commitment_loss': 0.07025157701214561, 'perplexity': 27.553759518791647}
2025-01-24 16:31:27,609 - Test Metrics: {'test_loss': 0.11299993805115736, 'test_recon_loss': 0.02320779709121849, 'test_codebook_loss': 0.07183371210777306, 'test_commitment_loss': 0.07183371210777306, 'test_perplexity': 29.06457200835023}
2025-01-24 16:31:27,634 - New best perplexity: 27.553759518791647
2025-01-24 16:31:42,323 - 
Epoch 4/100
2025-01-24 16:31:42,323 - Train Metrics: {'loss': 0.112332612447574, 'recon_loss': 0.02220157564372358, 'codebook_loss': 0.07210482860846287, 'commitment_loss': 0.07210482860846287, 'perplexity': 30.040746410789392}
2025-01-24 16:31:42,323 - Test Metrics: {'test_loss': 0.11433909437324427, 'test_recon_loss': 0.021690626687641386, 'test_codebook_loss': 0.07411877348830428, 'test_commitment_loss': 0.07411877348830428, 'test_perplexity': 31.6629136242444}
2025-01-24 16:31:42,363 - New best perplexity: 30.040746410789392
2025-01-24 16:31:57,064 - 
Epoch 5/100
2025-01-24 16:31:57,065 - Train Metrics: {'loss': 0.11058513259948671, 'recon_loss': 0.0206489005623876, 'codebook_loss': 0.0719489854429384, 'commitment_loss': 0.0719489854429384, 'perplexity': 32.42302838005983}
2025-01-24 16:31:57,065 - Test Metrics: {'test_loss': 0.1114311150357693, 'test_recon_loss': 0.02063361010691033, 'test_codebook_loss': 0.07263800398081163, 'test_commitment_loss': 0.07263800398081163, 'test_perplexity': 33.62349024905434}
2025-01-24 16:31:57,103 - New best perplexity: 32.42302838005983
2025-01-24 16:32:11,882 - 
Epoch 6/100
2025-01-24 16:32:11,883 - Train Metrics: {'loss': 0.1055327767644392, 'recon_loss': 0.019547333850351442, 'codebook_loss': 0.06878835407783614, 'commitment_loss': 0.06878835407783614, 'perplexity': 36.387612189173396}
2025-01-24 16:32:11,883 - Test Metrics: {'test_loss': 0.10218532326855237, 'test_recon_loss': 0.018818617173576656, 'test_codebook_loss': 0.06669336434783815, 'test_commitment_loss': 0.06669336434783815, 'test_perplexity': 40.203701598734796}
2025-01-24 16:32:11,923 - New best perplexity: 36.387612189173396
2025-01-24 16:32:26,672 - 
Epoch 7/100
2025-01-24 16:32:26,672 - Train Metrics: {'loss': 0.10004482389715931, 'recon_loss': 0.018527774788115337, 'codebook_loss': 0.06521363922244752, 'commitment_loss': 0.06521363922244752, 'perplexity': 41.05503467647621}
2025-01-24 16:32:26,672 - Test Metrics: {'test_loss': 0.09649319022516661, 'test_recon_loss': 0.018086612884756884, 'test_codebook_loss': 0.06272526217412346, 'test_commitment_loss': 0.06272526217412346, 'test_perplexity': 42.82271672502349}
2025-01-24 16:32:26,697 - New best perplexity: 41.05503467647621
2025-01-24 16:32:41,331 - 
Epoch 8/100
2025-01-24 16:32:41,331 - Train Metrics: {'loss': 0.0962535310393709, 'recon_loss': 0.01770087912716829, 'codebook_loss': 0.06284212138113159, 'commitment_loss': 0.06284212138113159, 'perplexity': 44.54585066109972}
2025-01-24 16:32:41,332 - Test Metrics: {'test_loss': 0.09060682252615312, 'test_recon_loss': 0.01734750711983895, 'test_codebook_loss': 0.058607452466518065, 'test_commitment_loss': 0.058607452466518065, 'test_perplexity': 47.00327479688427}
2025-01-24 16:32:41,356 - New best perplexity: 44.54585066109972
2025-01-24 16:32:56,067 - 
Epoch 9/100
2025-01-24 16:32:56,068 - Train Metrics: {'loss': 0.09000109440987678, 'recon_loss': 0.016889211340614444, 'codebook_loss': 0.05848950651638648, 'commitment_loss': 0.05848950651638648, 'perplexity': 50.20160923833432}
2025-01-24 16:32:56,068 - Test Metrics: {'test_loss': 0.08621810433230823, 'test_recon_loss': 0.01690851782649001, 'test_codebook_loss': 0.055447669063187856, 'test_commitment_loss': 0.055447669063187856, 'test_perplexity': 51.83065737953669}
2025-01-24 16:32:56,091 - New best perplexity: 50.20160923833432
2025-01-24 16:33:10,835 - 
Epoch 10/100
2025-01-24 16:33:10,836 - Train Metrics: {'loss': 0.0871549524995677, 'recon_loss': 0.0163395796399897, 'codebook_loss': 0.05665229823049682, 'commitment_loss': 0.05665229823049682, 'perplexity': 54.15978538532696}
2025-01-24 16:33:10,836 - Test Metrics: {'test_loss': 0.08535095738081992, 'test_recon_loss': 0.016535655878295627, 'test_codebook_loss': 0.05505224138121061, 'test_commitment_loss': 0.05505224138121061, 'test_perplexity': 59.84972188442568}
2025-01-24 16:33:10,859 - New best perplexity: 54.15978538532696
2025-01-24 16:33:25,657 - 
Epoch 11/100
2025-01-24 16:33:25,657 - Train Metrics: {'loss': 0.08056387333842495, 'recon_loss': 0.0156549614427797, 'codebook_loss': 0.05192712946887821, 'commitment_loss': 0.05192712946887821, 'perplexity': 63.911106724263455}
2025-01-24 16:33:25,657 - Test Metrics: {'test_loss': 0.07818627121705043, 'test_recon_loss': 0.01551571529641559, 'test_codebook_loss': 0.0501364448779746, 'test_commitment_loss': 0.0501364448779746, 'test_perplexity': 67.07390555852577}
2025-01-24 16:33:25,682 - New best perplexity: 63.911106724263455
2025-01-24 16:33:40,589 - 
Epoch 12/100
2025-01-24 16:33:40,590 - Train Metrics: {'loss': 0.07808178766151828, 'recon_loss': 0.015154960198456522, 'codebook_loss': 0.05034146204476466, 'commitment_loss': 0.05034146204476466, 'perplexity': 69.9741732897356}
2025-01-24 16:33:40,590 - Test Metrics: {'test_loss': 0.07602755348139172, 'test_recon_loss': 0.015351658050395265, 'test_codebook_loss': 0.04854071640138385, 'test_commitment_loss': 0.04854071640138385, 'test_perplexity': 72.10435524469689}
2025-01-24 16:33:40,627 - New best perplexity: 69.9741732897356
2025-01-24 16:33:55,553 - 
Epoch 13/100
2025-01-24 16:33:55,553 - Train Metrics: {'loss': 0.07585479717349153, 'recon_loss': 0.014765778196799329, 'codebook_loss': 0.04887121526138557, 'commitment_loss': 0.04887121526138557, 'perplexity': 75.30528140250983}
2025-01-24 16:33:55,553 - Test Metrics: {'test_loss': 0.07652713726215725, 'test_recon_loss': 0.014685187665627727, 'test_codebook_loss': 0.04947355979039699, 'test_commitment_loss': 0.04947355979039699, 'test_perplexity': 79.12738857993597}
2025-01-24 16:33:55,577 - New best perplexity: 75.30528140250983
2025-01-24 16:34:10,427 - 
Epoch 14/100
2025-01-24 16:34:10,428 - Train Metrics: {'loss': 0.0734258138996256, 'recon_loss': 0.01434164553823526, 'codebook_loss': 0.04726733455953695, 'commitment_loss': 0.04726733455953695, 'perplexity': 82.26717277195142}
2025-01-24 16:34:10,428 - Test Metrics: {'test_loss': 0.07232360117420365, 'test_recon_loss': 0.014317889910049831, 'test_codebook_loss': 0.0464045689735986, 'test_commitment_loss': 0.0464045689735986, 'test_perplexity': 85.52438895310027}
2025-01-24 16:34:10,452 - New best perplexity: 82.26717277195142
2025-01-24 16:34:25,232 - 
Epoch 15/100
2025-01-24 16:34:25,233 - Train Metrics: {'loss': 0.07141850578129444, 'recon_loss': 0.013994135741439774, 'codebook_loss': 0.04593949597281263, 'commitment_loss': 0.04593949597281263, 'perplexity': 89.2962007449411}
2025-01-24 16:34:25,233 - Test Metrics: {'test_loss': 0.07119077453507652, 'test_recon_loss': 0.013994518455259407, 'test_codebook_loss': 0.04575700459035137, 'test_commitment_loss': 0.04575700459035137, 'test_perplexity': 94.14068120642554}
2025-01-24 16:34:25,259 - New best perplexity: 89.2962007449411
2025-01-24 16:34:40,353 - 
Epoch 16/100
2025-01-24 16:34:40,354 - Train Metrics: {'loss': 0.06962926527651984, 'recon_loss': 0.013674527916418927, 'codebook_loss': 0.04476378961940251, 'commitment_loss': 0.04476378961940251, 'perplexity': 96.86555209733031}
2025-01-24 16:34:40,354 - Test Metrics: {'test_loss': 0.06892654667549496, 'test_recon_loss': 0.013681625074978117, 'test_codebook_loss': 0.044195936780564396, 'test_commitment_loss': 0.044195936780564396, 'test_perplexity': 100.05645877500123}
2025-01-24 16:34:40,378 - New best perplexity: 96.86555209733031
2025-01-24 16:34:55,118 - 
Epoch 17/100
2025-01-24 16:34:55,119 - Train Metrics: {'loss': 0.06799929993003226, 'recon_loss': 0.013409581604649496, 'codebook_loss': 0.04367177436113967, 'commitment_loss': 0.04367177436113967, 'perplexity': 102.8961732869258}
2025-01-24 16:34:55,119 - Test Metrics: {'test_loss': 0.06727771611907814, 'test_recon_loss': 0.013591308476804178, 'test_codebook_loss': 0.04294912531217442, 'test_commitment_loss': 0.04294912531217442, 'test_perplexity': 107.53531723988208}
2025-01-24 16:34:55,142 - New best perplexity: 102.8961732869258
2025-01-24 16:35:09,850 - 
Epoch 18/100
2025-01-24 16:35:09,850 - Train Metrics: {'loss': 0.06617472245527045, 'recon_loss': 0.013105444795907, 'codebook_loss': 0.04245542170827651, 'commitment_loss': 0.04245542170827651, 'perplexity': 111.18687911167778}
2025-01-24 16:35:09,850 - Test Metrics: {'test_loss': 0.06687099071620387, 'test_recon_loss': 0.013970565239462671, 'test_codebook_loss': 0.04232034025878846, 'test_commitment_loss': 0.04232034025878846, 'test_perplexity': 116.98022316075578}
2025-01-24 16:35:09,875 - New best perplexity: 111.18687911167778
2025-01-24 16:35:24,671 - 
Epoch 19/100
2025-01-24 16:35:24,672 - Train Metrics: {'loss': 0.06400358731217702, 'recon_loss': 0.012797919001973346, 'codebook_loss': 0.04096453428230322, 'commitment_loss': 0.04096453428230322, 'perplexity': 121.2789099417684}
2025-01-24 16:35:24,672 - Test Metrics: {'test_loss': 0.06291908572746228, 'test_recon_loss': 0.01288139841318885, 'test_codebook_loss': 0.040030149625071995, 'test_commitment_loss': 0.040030149625071995, 'test_perplexity': 126.98077914081043}
2025-01-24 16:35:24,696 - New best perplexity: 121.2789099417684
2025-01-24 16:35:39,484 - 
Epoch 20/100
2025-01-24 16:35:39,484 - Train Metrics: {'loss': 0.06262506630338366, 'recon_loss': 0.012551601225857996, 'codebook_loss': 0.04005877172474361, 'commitment_loss': 0.04005877172474361, 'perplexity': 130.17993636265436}
2025-01-24 16:35:39,484 - Test Metrics: {'test_loss': 0.06110732384686229, 'test_recon_loss': 0.012746600186617314, 'test_codebook_loss': 0.038688578701849226, 'test_commitment_loss': 0.038688578701849226, 'test_perplexity': 133.2537753913976}
2025-01-24 16:35:39,520 - New best perplexity: 130.17993636265436
2025-01-24 16:35:54,523 - 
Epoch 21/100
2025-01-24 16:35:54,523 - Train Metrics: {'loss': 0.061573651869354956, 'recon_loss': 0.012336249098829601, 'codebook_loss': 0.039389921728607336, 'commitment_loss': 0.039389921728607336, 'perplexity': 137.07696814183385}
2025-01-24 16:35:54,524 - Test Metrics: {'test_loss': 0.06092414377799517, 'test_recon_loss': 0.012477799813864352, 'test_codebook_loss': 0.038757075190166884, 'test_commitment_loss': 0.038757075190166884, 'test_perplexity': 141.87541044211085}
2025-01-24 16:35:54,559 - New best perplexity: 137.07696814183385
2025-01-24 16:36:09,377 - 
Epoch 22/100
2025-01-24 16:36:09,378 - Train Metrics: {'loss': 0.05999892578481713, 'recon_loss': 0.012088322068762291, 'codebook_loss': 0.03832848264318903, 'commitment_loss': 0.03832848264318903, 'perplexity': 146.9374592188374}
2025-01-24 16:36:09,378 - Test Metrics: {'test_loss': 0.05905066043892993, 'test_recon_loss': 0.012459374068281319, 'test_codebook_loss': 0.03727302888903437, 'test_commitment_loss': 0.03727302888903437, 'test_perplexity': 152.2599321196351}
2025-01-24 16:36:09,402 - New best perplexity: 146.9374592188374
2025-01-24 16:36:24,241 - 
Epoch 23/100
2025-01-24 16:36:24,241 - Train Metrics: {'loss': 0.058865971377362374, 'recon_loss': 0.01191021864781218, 'codebook_loss': 0.037564601815874926, 'commitment_loss': 0.037564601815874926, 'perplexity': 156.03563742869346}
2025-01-24 16:36:24,241 - Test Metrics: {'test_loss': 0.05901067194682133, 'test_recon_loss': 0.012194335248462761, 'test_codebook_loss': 0.037453069056891185, 'test_commitment_loss': 0.037453069056891185, 'test_perplexity': 160.65094341809237}
2025-01-24 16:36:24,278 - New best perplexity: 156.03563742869346
2025-01-24 16:36:39,211 - 
Epoch 24/100
2025-01-24 16:36:39,212 - Train Metrics: {'loss': 0.05807306255449724, 'recon_loss': 0.011707430133772323, 'codebook_loss': 0.037092505627885804, 'commitment_loss': 0.037092505627885804, 'perplexity': 163.44133943913843}
2025-01-24 16:36:39,212 - Test Metrics: {'test_loss': 0.057987401474125774, 'test_recon_loss': 0.011926106295159345, 'test_codebook_loss': 0.036849035916826395, 'test_commitment_loss': 0.036849035916826395, 'test_perplexity': 167.05195308637016}
2025-01-24 16:36:39,244 - New best perplexity: 163.44133943913843
2025-01-24 16:36:54,076 - 
Epoch 25/100
2025-01-24 16:36:54,076 - Train Metrics: {'loss': 0.057397337673265304, 'recon_loss': 0.011580771978592018, 'codebook_loss': 0.036653252256572094, 'commitment_loss': 0.036653252256572094, 'perplexity': 169.58389676379426}
2025-01-24 16:36:54,076 - Test Metrics: {'test_loss': 0.05740684096383143, 'test_recon_loss': 0.011855364965770063, 'test_codebook_loss': 0.03644118033632447, 'test_commitment_loss': 0.03644118033632447, 'test_perplexity': 173.69819872892356}
2025-01-24 16:36:54,100 - New best perplexity: 169.58389676379426
2025-01-24 16:37:08,984 - 
Epoch 26/100
2025-01-24 16:37:08,985 - Train Metrics: {'loss': 0.05663130742014217, 'recon_loss': 0.011433337164847443, 'codebook_loss': 0.03615837587076989, 'commitment_loss': 0.03615837587076989, 'perplexity': 175.11505708426162}
2025-01-24 16:37:08,985 - Test Metrics: {'test_loss': 0.055525546068254904, 'test_recon_loss': 0.011643233602937264, 'test_codebook_loss': 0.03510584974590736, 'test_commitment_loss': 0.03510584974590736, 'test_perplexity': 176.1460169538667}
2025-01-24 16:37:09,008 - New best perplexity: 175.11505708426162
2025-01-24 16:37:23,744 - 
Epoch 27/100
2025-01-24 16:37:23,744 - Train Metrics: {'loss': 0.05585641029012173, 'recon_loss': 0.011294285045064929, 'codebook_loss': 0.03564969986639059, 'commitment_loss': 0.03564969986639059, 'perplexity': 181.18870001985593}
2025-01-24 16:37:23,744 - Test Metrics: {'test_loss': 0.05485398171445991, 'test_recon_loss': 0.011606314938656891, 'test_codebook_loss': 0.03459813299624226, 'test_commitment_loss': 0.03459813299624226, 'test_perplexity': 184.8841378900069}
2025-01-24 16:37:23,768 - New best perplexity: 181.18870001985593
2025-01-24 16:37:38,626 - 
Epoch 28/100
2025-01-24 16:37:38,626 - Train Metrics: {'loss': 0.055198476623619916, 'recon_loss': 0.011178269775112723, 'codebook_loss': 0.035216165139623314, 'commitment_loss': 0.035216165139623314, 'perplexity': 188.26793649190526}
2025-01-24 16:37:38,626 - Test Metrics: {'test_loss': 0.05686233022922202, 'test_recon_loss': 0.011459979452664339, 'test_codebook_loss': 0.0363218802722949, 'test_commitment_loss': 0.0363218802722949, 'test_perplexity': 192.2561218648017}
2025-01-24 16:37:38,649 - New best perplexity: 188.26793649190526
2025-01-24 16:37:53,601 - 
Epoch 29/100
2025-01-24 16:37:53,601 - Train Metrics: {'loss': 0.0545557009918458, 'recon_loss': 0.01103934582770633, 'codebook_loss': 0.034813083946476205, 'commitment_loss': 0.034813083946476205, 'perplexity': 194.06685410131274}
2025-01-24 16:37:53,601 - Test Metrics: {'test_loss': 0.0532599781415885, 'test_recon_loss': 0.011485689673337001, 'test_codebook_loss': 0.03341943049166776, 'test_commitment_loss': 0.03341943049166776, 'test_perplexity': 196.8838881480543}
2025-01-24 16:37:53,626 - New best perplexity: 194.06685410131274
2025-01-24 16:38:08,592 - 
Epoch 30/100
2025-01-24 16:38:08,592 - Train Metrics: {'loss': 0.054052053710155167, 'recon_loss': 0.010935860628838582, 'codebook_loss': 0.03449295430689517, 'commitment_loss': 0.03449295430689517, 'perplexity': 200.7777543324034}
2025-01-24 16:38:08,592 - Test Metrics: {'test_loss': 0.05403668490014499, 'test_recon_loss': 0.011436011618639849, 'test_codebook_loss': 0.034080538097061686, 'test_commitment_loss': 0.034080538097061686, 'test_perplexity': 203.1622940256626}
2025-01-24 16:38:08,621 - New best perplexity: 200.7777543324034
2025-01-24 16:38:23,598 - 
Epoch 31/100
2025-01-24 16:38:23,598 - Train Metrics: {'loss': 0.05345804711132098, 'recon_loss': 0.010810962037357224, 'codebook_loss': 0.034117667881004954, 'commitment_loss': 0.034117667881004954, 'perplexity': 206.5162211464494}
2025-01-24 16:38:23,598 - Test Metrics: {'test_loss': 0.05348543247467355, 'test_recon_loss': 0.011192127201659016, 'test_codebook_loss': 0.03383464375628701, 'test_commitment_loss': 0.03383464375628701, 'test_perplexity': 209.4101388665694}
2025-01-24 16:38:23,625 - New best perplexity: 206.5162211464494
2025-01-24 16:38:38,527 - 
Epoch 32/100
2025-01-24 16:38:38,527 - Train Metrics: {'loss': 0.053056597623907395, 'recon_loss': 0.010700940354572384, 'codebook_loss': 0.033884525708758925, 'commitment_loss': 0.033884525708758925, 'perplexity': 212.21150160689487}
2025-01-24 16:38:38,527 - Test Metrics: {'test_loss': 0.053034916944518874, 'test_recon_loss': 0.011065639626187614, 'test_codebook_loss': 0.03357542134066926, 'test_commitment_loss': 0.03357542134066926, 'test_perplexity': 214.47492923012263}
2025-01-24 16:38:38,549 - New best perplexity: 212.21150160689487
2025-01-24 16:38:53,306 - 
Epoch 33/100
2025-01-24 16:38:53,306 - Train Metrics: {'loss': 0.05260709330172795, 'recon_loss': 0.010626964232958187, 'codebook_loss': 0.033584102964424115, 'commitment_loss': 0.033584102964424115, 'perplexity': 217.59350952772837}
2025-01-24 16:38:53,306 - Test Metrics: {'test_loss': 0.05253759196287469, 'test_recon_loss': 0.01107332912049716, 'test_codebook_loss': 0.033171410118288634, 'test_commitment_loss': 0.033171410118288634, 'test_perplexity': 220.47572326660156}
2025-01-24 16:38:53,331 - New best perplexity: 217.59350952772837
2025-01-24 16:39:08,073 - 
Epoch 34/100
2025-01-24 16:39:08,073 - Train Metrics: {'loss': 0.0520047841455473, 'recon_loss': 0.010518829395418124, 'codebook_loss': 0.0331887635247558, 'commitment_loss': 0.0331887635247558, 'perplexity': 223.38697768111362}
2025-01-24 16:39:08,073 - Test Metrics: {'test_loss': 0.05105321052708203, 'test_recon_loss': 0.010843840946408011, 'test_codebook_loss': 0.03216749547591692, 'test_commitment_loss': 0.03216749547591692, 'test_perplexity': 224.65147052233732}
2025-01-24 16:39:08,095 - New best perplexity: 223.38697768111362
2025-01-24 16:39:22,891 - 
Epoch 35/100
2025-01-24 16:39:22,891 - Train Metrics: {'loss': 0.05143860357877848, 'recon_loss': 0.010439495856175795, 'codebook_loss': 0.032799285986577456, 'commitment_loss': 0.032799285986577456, 'perplexity': 229.34571315443424}
2025-01-24 16:39:22,891 - Test Metrics: {'test_loss': 0.05076780382402336, 'test_recon_loss': 0.01083345687653445, 'test_codebook_loss': 0.031947477473111094, 'test_commitment_loss': 0.031947477473111094, 'test_perplexity': 232.6156376705894}
2025-01-24 16:39:22,916 - New best perplexity: 229.34571315443424
2025-01-24 16:39:37,649 - 
Epoch 36/100
2025-01-24 16:39:37,649 - Train Metrics: {'loss': 0.05109616223236789, 'recon_loss': 0.010357744053311056, 'codebook_loss': 0.0325907343793708, 'commitment_loss': 0.0325907343793708, 'perplexity': 234.69191935117288}
2025-01-24 16:39:37,649 - Test Metrics: {'test_loss': 0.05102503375162052, 'test_recon_loss': 0.010762805850068224, 'test_codebook_loss': 0.03220978174122829, 'test_commitment_loss': 0.03220978174122829, 'test_perplexity': 235.36362293098546}
2025-01-24 16:39:37,680 - New best perplexity: 234.69191935117288
2025-01-24 16:39:52,434 - 
Epoch 37/100
2025-01-24 16:39:52,434 - Train Metrics: {'loss': 0.05089718620757313, 'recon_loss': 0.010293741867689372, 'codebook_loss': 0.03248275544904077, 'commitment_loss': 0.03248275544904077, 'perplexity': 239.39691126986844}
2025-01-24 16:39:52,435 - Test Metrics: {'test_loss': 0.05107233432840697, 'test_recon_loss': 0.010824373769986479, 'test_codebook_loss': 0.03219836825339854, 'test_commitment_loss': 0.03219836825339854, 'test_perplexity': 240.53045847446103}
2025-01-24 16:39:52,457 - New best perplexity: 239.39691126986844
2025-01-24 16:40:07,208 - 
Epoch 38/100
2025-01-24 16:40:07,209 - Train Metrics: {'loss': 0.05060412474643544, 'recon_loss': 0.010218254623987028, 'codebook_loss': 0.03230869593313131, 'commitment_loss': 0.03230869593313131, 'perplexity': 243.9498293357127}
2025-01-24 16:40:07,209 - Test Metrics: {'test_loss': 0.05268897738637803, 'test_recon_loss': 0.010937756611199318, 'test_codebook_loss': 0.033400976488107366, 'test_commitment_loss': 0.033400976488107366, 'test_perplexity': 247.5486508140081}
2025-01-24 16:40:07,231 - New best perplexity: 243.9498293357127
2025-01-24 16:40:21,973 - 
Epoch 39/100
2025-01-24 16:40:21,973 - Train Metrics: {'loss': 0.05030598707706727, 'recon_loss': 0.010146882706571875, 'codebook_loss': 0.032127283332521656, 'commitment_loss': 0.032127283332521656, 'perplexity': 248.83942489428898}
2025-01-24 16:40:21,973 - Test Metrics: {'test_loss': 0.04953815514528299, 'test_recon_loss': 0.010656799566990968, 'test_codebook_loss': 0.031105084203277962, 'test_commitment_loss': 0.031105084203277962, 'test_perplexity': 249.1149139404297}
2025-01-24 16:40:21,999 - New best perplexity: 248.83942489428898
2025-01-24 16:40:36,564 - 
Epoch 40/100
2025-01-24 16:40:36,564 - Train Metrics: {'loss': 0.049889002081073455, 'recon_loss': 0.01008616595783883, 'codebook_loss': 0.031842268860477314, 'commitment_loss': 0.031842268860477314, 'perplexity': 255.4619575754151}
2025-01-24 16:40:36,564 - Test Metrics: {'test_loss': 0.04999276410929764, 'test_recon_loss': 0.010794907089181339, 'test_codebook_loss': 0.031358285488772994, 'test_commitment_loss': 0.031358285488772994, 'test_perplexity': 257.0416545626483}
2025-01-24 16:40:36,585 - New best perplexity: 255.4619575754151
2025-01-24 16:40:51,201 - 
Epoch 41/100
2025-01-24 16:40:51,201 - Train Metrics: {'loss': 0.049476543408068244, 'recon_loss': 0.010002763737040713, 'codebook_loss': 0.031579023670128846, 'commitment_loss': 0.031579023670128846, 'perplexity': 260.4509730034167}
2025-01-24 16:40:51,201 - Test Metrics: {'test_loss': 0.049820120481750635, 'test_recon_loss': 0.010426747541921803, 'test_codebook_loss': 0.031514697955756246, 'test_commitment_loss': 0.031514697955756246, 'test_perplexity': 263.6726767624481}
2025-01-24 16:40:51,223 - New best perplexity: 260.4509730034167
2025-01-24 16:41:05,808 - 
Epoch 42/100
2025-01-24 16:41:05,808 - Train Metrics: {'loss': 0.049225517217536714, 'recon_loss': 0.009917270873323121, 'codebook_loss': 0.03144659695532316, 'commitment_loss': 0.03144659695532316, 'perplexity': 266.1055632686371}
2025-01-24 16:41:05,808 - Test Metrics: {'test_loss': 0.04916136933467056, 'test_recon_loss': 0.010353684048109416, 'test_codebook_loss': 0.03104614798875549, 'test_commitment_loss': 0.03104614798875549, 'test_perplexity': 267.1263935716846}
2025-01-24 16:41:05,833 - New best perplexity: 266.1055632686371
2025-01-24 16:41:20,491 - 
Epoch 43/100
2025-01-24 16:41:20,491 - Train Metrics: {'loss': 0.048990901531008504, 'recon_loss': 0.009881595845150826, 'codebook_loss': 0.03128744449342608, 'commitment_loss': 0.03128744449342608, 'perplexity': 271.71305343745007}
2025-01-24 16:41:20,491 - Test Metrics: {'test_loss': 0.048764442105459264, 'test_recon_loss': 0.010338743464856208, 'test_codebook_loss': 0.030740558605971215, 'test_commitment_loss': 0.030740558605971215, 'test_perplexity': 272.15246504771557}
2025-01-24 16:41:20,520 - New best perplexity: 271.71305343745007
2025-01-24 16:41:35,317 - 
Epoch 44/100
2025-01-24 16:41:35,317 - Train Metrics: {'loss': 0.04878665624981951, 'recon_loss': 0.009797853050882098, 'codebook_loss': 0.031191042450535326, 'commitment_loss': 0.031191042450535326, 'perplexity': 276.8402809084529}
2025-01-24 16:41:35,317 - Test Metrics: {'test_loss': 0.04967430922426755, 'test_recon_loss': 0.010318341040158574, 'test_codebook_loss': 0.03148477456143385, 'test_commitment_loss': 0.03148477456143385, 'test_perplexity': 278.9531186260755}
2025-01-24 16:41:35,339 - New best perplexity: 276.8402809084529
2025-01-24 16:41:50,243 - 
Epoch 45/100
2025-01-24 16:41:50,243 - Train Metrics: {'loss': 0.048735653738612716, 'recon_loss': 0.009757909216367832, 'codebook_loss': 0.031182195472023676, 'commitment_loss': 0.031182195472023676, 'perplexity': 280.964465051051}
2025-01-24 16:41:50,243 - Test Metrics: {'test_loss': 0.049601902124247976, 'test_recon_loss': 0.010347733851757985, 'test_codebook_loss': 0.031403334457663044, 'test_commitment_loss': 0.031403334457663044, 'test_perplexity': 280.576703228528}
2025-01-24 16:41:50,280 - New best perplexity: 280.964465051051
2025-01-24 16:42:05,487 - 
Epoch 46/100
2025-01-24 16:42:05,488 - Train Metrics: {'loss': 0.04865858771497636, 'recon_loss': 0.009700227786055612, 'codebook_loss': 0.031166687912648292, 'commitment_loss': 0.031166687912648292, 'perplexity': 284.1520487987782}
2025-01-24 16:42:05,488 - Test Metrics: {'test_loss': 0.049545241637697704, 'test_recon_loss': 0.010235989702087415, 'test_codebook_loss': 0.031447401341003704, 'test_commitment_loss': 0.031447401341003704, 'test_perplexity': 288.8426532986798}
2025-01-24 16:42:05,520 - New best perplexity: 284.1520487987782
2025-01-24 16:42:20,446 - 
Epoch 47/100
2025-01-24 16:42:20,446 - Train Metrics: {'loss': 0.04853450465956917, 'recon_loss': 0.009667729930309078, 'codebook_loss': 0.031093419670029675, 'commitment_loss': 0.031093419670029675, 'perplexity': 287.50165895427887}
2025-01-24 16:42:20,447 - Test Metrics: {'test_loss': 0.04818938087813462, 'test_recon_loss': 0.01017118162840982, 'test_codebook_loss': 0.03041455911213084, 'test_commitment_loss': 0.03041455911213084, 'test_perplexity': 288.9491729736328}
2025-01-24 16:42:20,469 - New best perplexity: 287.50165895427887
2025-01-24 16:42:35,192 - 
Epoch 48/100
2025-01-24 16:42:35,192 - Train Metrics: {'loss': 0.04842818744690217, 'recon_loss': 0.009631415905283235, 'codebook_loss': 0.031037417095144997, 'commitment_loss': 0.031037417095144997, 'perplexity': 291.0135592487462}
2025-01-24 16:42:35,192 - Test Metrics: {'test_loss': 0.04860902115514007, 'test_recon_loss': 0.010336422231755679, 'test_codebook_loss': 0.030618078935938545, 'test_commitment_loss': 0.030618078935938545, 'test_perplexity': 290.0215826879574}
2025-01-24 16:42:35,221 - New best perplexity: 291.0135592487462
2025-01-24 16:42:50,081 - 
Epoch 49/100
2025-01-24 16:42:50,082 - Train Metrics: {'loss': 0.04835558028134239, 'recon_loss': 0.009575722636678791, 'codebook_loss': 0.031023886064281855, 'commitment_loss': 0.031023886064281855, 'perplexity': 293.84360911962017}
2025-01-24 16:42:50,082 - Test Metrics: {'test_loss': 0.04863247709183753, 'test_recon_loss': 0.010389567576820337, 'test_codebook_loss': 0.030594327333795874, 'test_commitment_loss': 0.030594327333795874, 'test_perplexity': 293.09649947926965}
2025-01-24 16:42:50,106 - New best perplexity: 293.84360911962017
2025-01-24 16:43:05,200 - 
Epoch 50/100
2025-01-24 16:43:05,201 - Train Metrics: {'loss': 0.048192079119441456, 'recon_loss': 0.009514876769955658, 'codebook_loss': 0.03094176190150211, 'commitment_loss': 0.03094176190150211, 'perplexity': 296.9581085751429}
2025-01-24 16:43:05,201 - Test Metrics: {'test_loss': 0.04831852202739897, 'test_recon_loss': 0.010101728046996683, 'test_codebook_loss': 0.030573434962690632, 'test_commitment_loss': 0.030573434962690632, 'test_perplexity': 297.49431156206737}
2025-01-24 16:43:05,225 - New best perplexity: 296.9581085751429
2025-01-24 16:43:20,211 - 
Epoch 51/100
2025-01-24 16:43:20,211 - Train Metrics: {'loss': 0.04819295315257729, 'recon_loss': 0.009494997913499012, 'codebook_loss': 0.03095836409598665, 'commitment_loss': 0.03095836409598665, 'perplexity': 299.96928628204427}
2025-01-24 16:43:20,211 - Test Metrics: {'test_loss': 0.048092570297325714, 'test_recon_loss': 0.010250101490771468, 'test_codebook_loss': 0.030273975026381166, 'test_commitment_loss': 0.030273975026381166, 'test_perplexity': 298.70960650866544}
2025-01-24 16:43:20,235 - New best perplexity: 299.96928628204427
2025-01-24 16:43:35,199 - 
Epoch 52/100
2025-01-24 16:43:35,199 - Train Metrics: {'loss': 0.048115147720746064, 'recon_loss': 0.009452248647180207, 'codebook_loss': 0.030930319153096363, 'commitment_loss': 0.030930319153096363, 'perplexity': 302.2669374900096}
2025-01-24 16:43:35,199 - Test Metrics: {'test_loss': 0.047948959224586245, 'test_recon_loss': 0.010113506271397765, 'test_codebook_loss': 0.030268362169212932, 'test_commitment_loss': 0.030268362169212932, 'test_perplexity': 304.5056183247627}
2025-01-24 16:43:35,223 - New best perplexity: 302.2669374900096
2025-01-24 16:43:50,117 - 
Epoch 53/100
2025-01-24 16:43:50,117 - Train Metrics: {'loss': 0.04798578822513676, 'recon_loss': 0.009421894626925364, 'codebook_loss': 0.0308511147937735, 'commitment_loss': 0.0308511147937735, 'perplexity': 304.3503319625659}
2025-01-24 16:43:50,117 - Test Metrics: {'test_loss': 0.04813112365671351, 'test_recon_loss': 0.010192840572305118, 'test_codebook_loss': 0.030350626175162158, 'test_commitment_loss': 0.030350626175162158, 'test_perplexity': 306.16838382769237}
2025-01-24 16:43:50,153 - New best perplexity: 304.3503319625659
2025-01-24 16:44:05,102 - 
Epoch 54/100
2025-01-24 16:44:05,103 - Train Metrics: {'loss': 0.04795662905363476, 'recon_loss': 0.009386032760200445, 'codebook_loss': 0.03085647702521985, 'commitment_loss': 0.03085647702521985, 'perplexity': 306.4131278503886}
2025-01-24 16:44:05,103 - Test Metrics: {'test_loss': 0.04835660043585149, 'test_recon_loss': 0.010090074855598468, 'test_codebook_loss': 0.030613220355744604, 'test_commitment_loss': 0.030613220355744604, 'test_perplexity': 305.7312861575356}
2025-01-24 16:44:05,127 - New best perplexity: 306.4131278503886
2025-01-24 16:44:20,120 - 
Epoch 55/100
2025-01-24 16:44:20,121 - Train Metrics: {'loss': 0.047874603849237835, 'recon_loss': 0.009352533870836352, 'codebook_loss': 0.030817655903642136, 'commitment_loss': 0.030817655903642136, 'perplexity': 307.88082198901554}
2025-01-24 16:44:20,121 - Test Metrics: {'test_loss': 0.04860099183419083, 'test_recon_loss': 0.01010081232112797, 'test_codebook_loss': 0.03080014335109463, 'test_commitment_loss': 0.03080014335109463, 'test_perplexity': 309.94504846500445}
2025-01-24 16:44:20,157 - New best perplexity: 307.88082198901554
2025-01-24 16:44:35,115 - 
Epoch 56/100
2025-01-24 16:44:35,115 - Train Metrics: {'loss': 0.04785285836747845, 'recon_loss': 0.009327496159011904, 'codebook_loss': 0.030820289660064157, 'commitment_loss': 0.030820289660064157, 'perplexity': 309.1911878658987}
2025-01-24 16:44:35,115 - Test Metrics: {'test_loss': 0.04720271067528785, 'test_recon_loss': 0.009994322186500966, 'test_codebook_loss': 0.029766710781598392, 'test_commitment_loss': 0.029766710781598392, 'test_perplexity': 306.98408411726166}
2025-01-24 16:44:35,139 - New best perplexity: 309.1911878658987
2025-01-24 16:44:49,969 - 
Epoch 57/100
2025-01-24 16:44:49,970 - Train Metrics: {'loss': 0.04772439332264464, 'recon_loss': 0.009289758222754045, 'codebook_loss': 0.030747708157086006, 'commitment_loss': 0.030747708157086006, 'perplexity': 310.50830039099964}
2025-01-24 16:44:49,970 - Test Metrics: {'test_loss': 0.048093808744149875, 'test_recon_loss': 0.009991391915592212, 'test_codebook_loss': 0.030481933439268343, 'test_commitment_loss': 0.030481933439268343, 'test_perplexity': 311.19027555441556}
2025-01-24 16:44:50,006 - New best perplexity: 310.50830039099964
2025-01-24 16:45:04,950 - 
Epoch 58/100
2025-01-24 16:45:04,951 - Train Metrics: {'loss': 0.04764938562193795, 'recon_loss': 0.009266810808473688, 'codebook_loss': 0.03070605991174803, 'commitment_loss': 0.03070605991174803, 'perplexity': 311.71226185362053}
2025-01-24 16:45:04,951 - Test Metrics: {'test_loss': 0.04815812423070775, 'test_recon_loss': 0.009907952144364768, 'test_codebook_loss': 0.030600137654927712, 'test_commitment_loss': 0.030600137654927712, 'test_perplexity': 310.71912490265277}
2025-01-24 16:45:04,990 - New best perplexity: 311.71226185362053
2025-01-24 16:45:20,149 - 
Epoch 59/100
2025-01-24 16:45:20,149 - Train Metrics: {'loss': 0.04758701322938475, 'recon_loss': 0.00924847260727297, 'codebook_loss': 0.030670832471012155, 'commitment_loss': 0.030670832471012155, 'perplexity': 312.4885488056466}
2025-01-24 16:45:20,150 - Test Metrics: {'test_loss': 0.047545077397099025, 'test_recon_loss': 0.009980069921363759, 'test_codebook_loss': 0.03005200584383705, 'test_commitment_loss': 0.03005200584383705, 'test_perplexity': 313.03867813303503}
2025-01-24 16:45:20,185 - New best perplexity: 312.4885488056466
2025-01-24 16:45:35,165 - 
Epoch 60/100
2025-01-24 16:45:35,165 - Train Metrics: {'loss': 0.047547924587183904, 'recon_loss': 0.009208488049428634, 'codebook_loss': 0.03067154915112516, 'commitment_loss': 0.03067154915112516, 'perplexity': 314.01790304744947}
2025-01-24 16:45:35,165 - Test Metrics: {'test_loss': 0.04894839995835401, 'test_recon_loss': 0.010068140534943417, 'test_codebook_loss': 0.031104207463279555, 'test_commitment_loss': 0.031104207463279555, 'test_perplexity': 315.80552963063684}
2025-01-24 16:45:35,202 - New best perplexity: 314.01790304744947
2025-01-24 16:45:50,091 - 
Epoch 61/100
2025-01-24 16:45:50,092 - Train Metrics: {'loss': 0.04742915793071927, 'recon_loss': 0.009185059272381656, 'codebook_loss': 0.030595278862835196, 'commitment_loss': 0.030595278862835196, 'perplexity': 314.6275175831202}
2025-01-24 16:45:50,092 - Test Metrics: {'test_loss': 0.047551706999163085, 'test_recon_loss': 0.009858348347906824, 'test_codebook_loss': 0.03015468677482273, 'test_commitment_loss': 0.03015468677482273, 'test_perplexity': 314.1132464831388}
2025-01-24 16:45:50,127 - New best perplexity: 314.6275175831202
2025-01-24 16:46:05,093 - 
Epoch 62/100
2025-01-24 16:46:05,094 - Train Metrics: {'loss': 0.04739164361906478, 'recon_loss': 0.009134729349952372, 'codebook_loss': 0.030605531419100968, 'commitment_loss': 0.030605531419100968, 'perplexity': 316.20358690032566}
2025-01-24 16:46:05,094 - Test Metrics: {'test_loss': 0.04726562361362614, 'test_recon_loss': 0.00993329260639752, 'test_codebook_loss': 0.029865864758627323, 'test_commitment_loss': 0.029865864758627323, 'test_perplexity': 317.1629007073897}
2025-01-24 16:46:05,117 - New best perplexity: 316.20358690032566
2025-01-24 16:46:19,972 - 
Epoch 63/100
2025-01-24 16:46:19,973 - Train Metrics: {'loss': 0.04743786333390819, 'recon_loss': 0.0091404353966341, 'codebook_loss': 0.030637942221196715, 'commitment_loss': 0.030637942221196715, 'perplexity': 317.5922679071841}
2025-01-24 16:46:19,973 - Test Metrics: {'test_loss': 0.04741247818817066, 'test_recon_loss': 0.00998555057788197, 'test_codebook_loss': 0.029941542168395428, 'test_commitment_loss': 0.029941542168395428, 'test_perplexity': 313.05762607236454}
2025-01-24 16:46:20,008 - New best perplexity: 317.5922679071841
2025-01-24 16:46:34,921 - 
Epoch 64/100
2025-01-24 16:46:34,921 - Train Metrics: {'loss': 0.04742400608289882, 'recon_loss': 0.009117544223756893, 'codebook_loss': 0.030645169427289683, 'commitment_loss': 0.030645169427289683, 'perplexity': 318.3123907298993}
2025-01-24 16:46:34,921 - Test Metrics: {'test_loss': 0.04850167983883544, 'test_recon_loss': 0.009887968909136857, 'test_codebook_loss': 0.030890968781483324, 'test_commitment_loss': 0.030890968781483324, 'test_perplexity': 319.6560908450356}
2025-01-24 16:46:34,945 - New best perplexity: 318.3123907298993
2025-01-24 16:46:49,813 - 
Epoch 65/100
2025-01-24 16:46:49,814 - Train Metrics: {'loss': 0.047374756516093186, 'recon_loss': 0.009070282399444782, 'codebook_loss': 0.030643579180893082, 'commitment_loss': 0.030643579180893082, 'perplexity': 319.0005780388327}
2025-01-24 16:46:49,814 - Test Metrics: {'test_loss': 0.047458027925672414, 'test_recon_loss': 0.009807050935452498, 'test_codebook_loss': 0.03012078182323824, 'test_commitment_loss': 0.03012078182323824, 'test_perplexity': 315.56601724745354}
2025-01-24 16:46:49,837 - New best perplexity: 319.0005780388327
2025-01-24 16:47:04,763 - 
Epoch 66/100
2025-01-24 16:47:04,763 - Train Metrics: {'loss': 0.047297896879255924, 'recon_loss': 0.009060484619187119, 'codebook_loss': 0.030589929779472252, 'commitment_loss': 0.030589929779472252, 'perplexity': 319.9395721513597}
2025-01-24 16:47:04,763 - Test Metrics: {'test_loss': 0.048740312457084656, 'test_recon_loss': 0.009864058086200606, 'test_codebook_loss': 0.031101003477845012, 'test_commitment_loss': 0.031101003477845012, 'test_perplexity': 318.47252027294303}
2025-01-24 16:47:04,799 - New best perplexity: 319.9395721513597
2025-01-24 16:47:19,779 - 
Epoch 67/100
2025-01-24 16:47:19,779 - Train Metrics: {'loss': 0.047366563983433085, 'recon_loss': 0.009047665940526197, 'codebook_loss': 0.030655118324758146, 'commitment_loss': 0.030655118324758146, 'perplexity': 320.8281449027683}
2025-01-24 16:47:19,779 - Test Metrics: {'test_loss': 0.0470774115735217, 'test_recon_loss': 0.009864362817304798, 'test_codebook_loss': 0.02977043887765347, 'test_commitment_loss': 0.02977043887765347, 'test_perplexity': 317.17321275155757}
2025-01-24 16:47:19,813 - New best perplexity: 320.8281449027683
2025-01-24 16:47:35,040 - 
Epoch 68/100
2025-01-24 16:47:35,040 - Train Metrics: {'loss': 0.04733453091719876, 'recon_loss': 0.009021427389472494, 'codebook_loss': 0.03065048266307015, 'commitment_loss': 0.03065048266307015, 'perplexity': 321.2874026871703}
2025-01-24 16:47:35,041 - Test Metrics: {'test_loss': 0.04780214162001127, 'test_recon_loss': 0.009905361711884601, 'test_codebook_loss': 0.030317423888776875, 'test_commitment_loss': 0.030317423888776875, 'test_perplexity': 314.68826023536394}
2025-01-24 16:47:35,078 - New best perplexity: 321.2874026871703
2025-01-24 16:47:50,031 - 
Epoch 69/100
2025-01-24 16:47:50,032 - Train Metrics: {'loss': 0.04727492892109524, 'recon_loss': 0.008990175352739098, 'codebook_loss': 0.03062780276226723, 'commitment_loss': 0.03062780276226723, 'perplexity': 321.1906655548174}
2025-01-24 16:47:50,032 - Test Metrics: {'test_loss': 0.04916524920093862, 'test_recon_loss': 0.009885556123490576, 'test_codebook_loss': 0.031423754306345045, 'test_commitment_loss': 0.031423754306345045, 'test_perplexity': 322.26597730419303}
2025-01-24 16:48:04,944 - 
Epoch 70/100
2025-01-24 16:48:04,944 - Train Metrics: {'loss': 0.047156913610904114, 'recon_loss': 0.008970777368377847, 'codebook_loss': 0.030548908978776858, 'commitment_loss': 0.030548908978776858, 'perplexity': 322.0251059763877}
2025-01-24 16:48:04,944 - Test Metrics: {'test_loss': 0.04675428607041323, 'test_recon_loss': 0.009812821645902681, 'test_codebook_loss': 0.029553171577332896, 'test_commitment_loss': 0.029553171577332896, 'test_perplexity': 318.1193874697142}
2025-01-24 16:48:04,976 - New best perplexity: 322.0251059763877
2025-01-24 16:48:19,915 - 
Epoch 71/100
2025-01-24 16:48:19,915 - Train Metrics: {'loss': 0.04705365307038398, 'recon_loss': 0.008957210685247961, 'codebook_loss': 0.030477153813785605, 'commitment_loss': 0.030477153813785605, 'perplexity': 323.3209008414422}
2025-01-24 16:48:19,915 - Test Metrics: {'test_loss': 0.04951546675985372, 'test_recon_loss': 0.009915418899323366, 'test_codebook_loss': 0.03168003822240648, 'test_commitment_loss': 0.03168003822240648, 'test_perplexity': 324.50744203977945}
2025-01-24 16:48:19,953 - New best perplexity: 323.3209008414422
2025-01-24 16:48:34,958 - 
Epoch 72/100
2025-01-24 16:48:34,958 - Train Metrics: {'loss': 0.04698438688998332, 'recon_loss': 0.008935785225933164, 'codebook_loss': 0.030438881381736387, 'commitment_loss': 0.030438881381736387, 'perplexity': 323.69644211869104}
2025-01-24 16:48:34,958 - Test Metrics: {'test_loss': 0.04792371920392483, 'test_recon_loss': 0.009861871340795409, 'test_codebook_loss': 0.0304494780735879, 'test_commitment_loss': 0.0304494780735879, 'test_perplexity': 324.69705238825156}
2025-01-24 16:48:34,983 - New best perplexity: 323.69644211869104
2025-01-24 16:48:49,753 - 
Epoch 73/100
2025-01-24 16:48:49,753 - Train Metrics: {'loss': 0.04693245028367128, 'recon_loss': 0.008912779028763246, 'codebook_loss': 0.030415737096344115, 'commitment_loss': 0.030415737096344115, 'perplexity': 324.4959801090953}
2025-01-24 16:48:49,753 - Test Metrics: {'test_loss': 0.04756263888712171, 'test_recon_loss': 0.00998198645354449, 'test_codebook_loss': 0.030064522159061854, 'test_commitment_loss': 0.030064522159061854, 'test_perplexity': 326.5985138325752}
2025-01-24 16:48:49,778 - New best perplexity: 324.4959801090953
2025-01-24 16:49:04,585 - 
Epoch 74/100
2025-01-24 16:49:04,585 - Train Metrics: {'loss': 0.04693650105572723, 'recon_loss': 0.008896886909385318, 'codebook_loss': 0.03043169123799447, 'commitment_loss': 0.03043169123799447, 'perplexity': 325.9963425736293}
2025-01-24 16:49:04,585 - Test Metrics: {'test_loss': 0.04847851923749417, 'test_recon_loss': 0.009818012036288841, 'test_codebook_loss': 0.030928405614781985, 'test_commitment_loss': 0.030928405614781985, 'test_perplexity': 328.25043381316755}
2025-01-24 16:49:04,609 - New best perplexity: 325.9963425736293
2025-01-24 16:49:19,413 - 
Epoch 75/100
2025-01-24 16:49:19,414 - Train Metrics: {'loss': 0.0468634151474899, 'recon_loss': 0.008881486059092652, 'codebook_loss': 0.030385543199260828, 'commitment_loss': 0.030385543199260828, 'perplexity': 326.47243614879716}
2025-01-24 16:49:19,414 - Test Metrics: {'test_loss': 0.0486820920170108, 'test_recon_loss': 0.009832857601061652, 'test_codebook_loss': 0.031079387575199333, 'test_commitment_loss': 0.031079387575199333, 'test_perplexity': 328.3369600320164}
2025-01-24 16:49:19,437 - New best perplexity: 326.47243614879716
2025-01-24 16:49:34,284 - 
Epoch 76/100
2025-01-24 16:49:34,285 - Train Metrics: {'loss': 0.04679968279531545, 'recon_loss': 0.008849605247425988, 'codebook_loss': 0.030360062042122608, 'commitment_loss': 0.030360062042122608, 'perplexity': 327.0523907205333}
2025-01-24 16:49:34,285 - Test Metrics: {'test_loss': 0.04756244290855866, 'test_recon_loss': 0.009860838091448892, 'test_codebook_loss': 0.030161283910274506, 'test_commitment_loss': 0.030161283910274506, 'test_perplexity': 325.0179381551622}
2025-01-24 16:49:34,320 - New best perplexity: 327.0523907205333
2025-01-24 16:49:49,496 - 
Epoch 77/100
2025-01-24 16:49:49,496 - Train Metrics: {'loss': 0.046799788332503776, 'recon_loss': 0.008852857655709815, 'codebook_loss': 0.030357544474741992, 'commitment_loss': 0.030357544474741992, 'perplexity': 327.3021884927969}
2025-01-24 16:49:49,496 - Test Metrics: {'test_loss': 0.04774788356845892, 'test_recon_loss': 0.009923044898653333, 'test_codebook_loss': 0.030259871124466764, 'test_commitment_loss': 0.030259871124466764, 'test_perplexity': 326.27883640723894}
2025-01-24 16:49:49,532 - New best perplexity: 327.3021884927969
2025-01-24 16:50:04,532 - 
Epoch 78/100
2025-01-24 16:50:04,533 - Train Metrics: {'loss': 0.046807756013882436, 'recon_loss': 0.00882095034184206, 'codebook_loss': 0.030389444459506008, 'commitment_loss': 0.030389444459506008, 'perplexity': 327.8789385627298}
2025-01-24 16:50:04,533 - Test Metrics: {'test_loss': 0.046573225691725936, 'test_recon_loss': 0.009702954111219962, 'test_codebook_loss': 0.029496217240826992, 'test_commitment_loss': 0.029496217240826992, 'test_perplexity': 326.39570830139934}
2025-01-24 16:50:04,568 - New best perplexity: 327.8789385627298
2025-01-24 16:50:19,575 - 
Epoch 79/100
2025-01-24 16:50:19,575 - Train Metrics: {'loss': 0.04673272027345875, 'recon_loss': 0.008799730993026052, 'codebook_loss': 0.030346391451023424, 'commitment_loss': 0.030346391451023424, 'perplexity': 328.35364948087334}
2025-01-24 16:50:19,575 - Test Metrics: {'test_loss': 0.04640853362558763, 'test_recon_loss': 0.009803811760171305, 'test_codebook_loss': 0.029283777398021914, 'test_commitment_loss': 0.029283777398021914, 'test_perplexity': 326.6141562160057}
2025-01-24 16:50:19,612 - New best perplexity: 328.35364948087334
2025-01-24 16:50:34,716 - 
Epoch 80/100
2025-01-24 16:50:34,717 - Train Metrics: {'loss': 0.04672967161402068, 'recon_loss': 0.008807210504170269, 'codebook_loss': 0.030337968788793326, 'commitment_loss': 0.030337968788793326, 'perplexity': 328.5398656352402}
2025-01-24 16:50:34,717 - Test Metrics: {'test_loss': 0.04742303028514114, 'test_recon_loss': 0.009817082222692574, 'test_codebook_loss': 0.030084758596141126, 'test_commitment_loss': 0.030084758596141126, 'test_perplexity': 328.40740812277494}
2025-01-24 16:50:34,752 - New best perplexity: 328.5398656352402
2025-01-24 16:50:49,827 - 
Epoch 81/100
2025-01-24 16:50:49,827 - Train Metrics: {'loss': 0.04671466276240166, 'recon_loss': 0.008765913748546787, 'codebook_loss': 0.0303589993149347, 'commitment_loss': 0.0303589993149347, 'perplexity': 328.726040579169}
2025-01-24 16:50:49,828 - Test Metrics: {'test_loss': 0.04843749926437305, 'test_recon_loss': 0.009904983029052426, 'test_codebook_loss': 0.030826012733616407, 'test_commitment_loss': 0.030826012733616407, 'test_perplexity': 332.40808993955204}
2025-01-24 16:50:49,863 - New best perplexity: 328.726040579169
2025-01-24 16:51:04,809 - 
Epoch 82/100
2025-01-24 16:51:04,809 - Train Metrics: {'loss': 0.04669854886201032, 'recon_loss': 0.008740580152443913, 'codebook_loss': 0.03036637499909419, 'commitment_loss': 0.03036637499909419, 'perplexity': 329.17374289432144}
2025-01-24 16:51:04,809 - Test Metrics: {'test_loss': 0.04698977506236185, 'test_recon_loss': 0.009779204461204855, 'test_codebook_loss': 0.029768456268725516, 'test_commitment_loss': 0.029768456268725516, 'test_perplexity': 326.4833748732941}
2025-01-24 16:51:04,833 - New best perplexity: 329.17374289432144
2025-01-24 16:51:19,647 - 
Epoch 83/100
2025-01-24 16:51:19,647 - Train Metrics: {'loss': 0.046749161761206436, 'recon_loss': 0.008738675478683866, 'codebook_loss': 0.03040838903745117, 'commitment_loss': 0.03040838903745117, 'perplexity': 329.31971892920296}
2025-01-24 16:51:19,648 - Test Metrics: {'test_loss': 0.04726498790934116, 'test_recon_loss': 0.0099102513911792, 'test_codebook_loss': 0.029883789110787307, 'test_commitment_loss': 0.029883789110787307, 'test_perplexity': 325.38657002509393}
2025-01-24 16:51:19,686 - New best perplexity: 329.31971892920296
2025-01-24 16:51:34,602 - 
Epoch 84/100
2025-01-24 16:51:34,602 - Train Metrics: {'loss': 0.04676491684277954, 'recon_loss': 0.008726856421174295, 'codebook_loss': 0.030430448310606924, 'commitment_loss': 0.030430448310606924, 'perplexity': 329.0168260345069}
2025-01-24 16:51:34,602 - Test Metrics: {'test_loss': 0.04839500516087194, 'test_recon_loss': 0.009791323750079432, 'test_codebook_loss': 0.030882945260669613, 'test_commitment_loss': 0.030882945260669613, 'test_perplexity': 327.89414688303503}
2025-01-24 16:51:49,669 - 
Epoch 85/100
2025-01-24 16:51:49,669 - Train Metrics: {'loss': 0.04673322087244305, 'recon_loss': 0.008732658996701698, 'codebook_loss': 0.030400449500593077, 'commitment_loss': 0.030400449500593077, 'perplexity': 329.3120511340363}
2025-01-24 16:51:49,669 - Test Metrics: {'test_loss': 0.047509272075906585, 'test_recon_loss': 0.009817847722693335, 'test_codebook_loss': 0.030153139293948306, 'test_commitment_loss': 0.030153139293948306, 'test_perplexity': 325.4291563396212}
2025-01-24 16:52:04,623 - 
Epoch 86/100
2025-01-24 16:52:04,623 - Train Metrics: {'loss': 0.04670655149061357, 'recon_loss': 0.008701306057955755, 'codebook_loss': 0.03040419625180304, 'commitment_loss': 0.03040419625180304, 'perplexity': 329.21841500909125}
2025-01-24 16:52:04,623 - Test Metrics: {'test_loss': 0.04750998238030868, 'test_recon_loss': 0.009810697169432158, 'test_codebook_loss': 0.03015942822057235, 'test_commitment_loss': 0.03015942822057235, 'test_perplexity': 330.1753424149525}
2025-01-24 16:52:19,513 - 
Epoch 87/100
2025-01-24 16:52:19,513 - Train Metrics: {'loss': 0.04669662544984952, 'recon_loss': 0.008695937414436847, 'codebook_loss': 0.030400550455007405, 'commitment_loss': 0.030400550455007405, 'perplexity': 330.13336205055646}
2025-01-24 16:52:19,513 - Test Metrics: {'test_loss': 0.04804714415458184, 'test_recon_loss': 0.009772707024424137, 'test_codebook_loss': 0.030619549883317342, 'test_commitment_loss': 0.030619549883317342, 'test_perplexity': 331.2512048648883}
2025-01-24 16:52:19,549 - New best perplexity: 330.13336205055646
2025-01-24 16:52:34,986 - 
Epoch 88/100
2025-01-24 16:52:34,986 - Train Metrics: {'loss': 0.04665718660177782, 'recon_loss': 0.008688452535682855, 'codebook_loss': 0.030374987246206655, 'commitment_loss': 0.030374987246206655, 'perplexity': 330.13011485536384}
2025-01-24 16:52:34,986 - Test Metrics: {'test_loss': 0.04842568495416943, 'test_recon_loss': 0.010067354074290281, 'test_codebook_loss': 0.030686664619023286, 'test_commitment_loss': 0.030686664619023286, 'test_perplexity': 330.11087229282043}
2025-01-24 16:52:49,775 - 
Epoch 89/100
2025-01-24 16:52:49,775 - Train Metrics: {'loss': 0.04662144730043838, 'recon_loss': 0.00869551339351079, 'codebook_loss': 0.030340747116967236, 'commitment_loss': 0.030340747116967236, 'perplexity': 330.082658460378}
2025-01-24 16:52:49,775 - Test Metrics: {'test_loss': 0.04847894123272051, 'test_recon_loss': 0.009845230292198779, 'test_codebook_loss': 0.030906968643959566, 'test_commitment_loss': 0.030906968643959566, 'test_perplexity': 327.88592181628263}
2025-01-24 16:53:04,677 - 
Epoch 90/100
2025-01-24 16:53:04,677 - Train Metrics: {'loss': 0.04654442690446249, 'recon_loss': 0.008659249987415112, 'codebook_loss': 0.030308141456464367, 'commitment_loss': 0.030308141456464367, 'perplexity': 329.58295918730516}
2025-01-24 16:53:04,677 - Test Metrics: {'test_loss': 0.04801703989505768, 'test_recon_loss': 0.009753851137489458, 'test_codebook_loss': 0.030610550831578955, 'test_commitment_loss': 0.030610550831578955, 'test_perplexity': 331.4999621427512}
2025-01-24 16:53:19,468 - 
Epoch 91/100
2025-01-24 16:53:19,468 - Train Metrics: {'loss': 0.04658947041844163, 'recon_loss': 0.008633917461975914, 'codebook_loss': 0.030364442364219816, 'commitment_loss': 0.030364442364219816, 'perplexity': 330.22326597716193}
2025-01-24 16:53:19,468 - Test Metrics: {'test_loss': 0.047305457954165304, 'test_recon_loss': 0.009695727790741227, 'test_codebook_loss': 0.030087783744063557, 'test_commitment_loss': 0.030087783744063557, 'test_perplexity': 326.96869166893293}
2025-01-24 16:53:19,494 - New best perplexity: 330.22326597716193
2025-01-24 16:53:34,294 - 
Epoch 92/100
2025-01-24 16:53:34,295 - Train Metrics: {'loss': 0.0465561691338144, 'recon_loss': 0.00863686181090372, 'codebook_loss': 0.03033544579068261, 'commitment_loss': 0.03033544579068261, 'perplexity': 330.0218252977142}
2025-01-24 16:53:34,295 - Test Metrics: {'test_loss': 0.04576763718188563, 'test_recon_loss': 0.009762581025214889, 'test_codebook_loss': 0.028804044816878777, 'test_commitment_loss': 0.028804044816878777, 'test_perplexity': 328.61423965647253}
2025-01-24 16:53:49,113 - 
Epoch 93/100
2025-01-24 16:53:49,114 - Train Metrics: {'loss': 0.04655032381987023, 'recon_loss': 0.00863452197607521, 'codebook_loss': 0.03033264146646118, 'commitment_loss': 0.03033264146646118, 'perplexity': 330.895407986458}
2025-01-24 16:53:49,114 - Test Metrics: {'test_loss': 0.04791857222024398, 'test_recon_loss': 0.009756425867163682, 'test_codebook_loss': 0.030529716936281964, 'test_commitment_loss': 0.030529716936281964, 'test_perplexity': 329.6963018103491}
2025-01-24 16:53:49,140 - New best perplexity: 330.895407986458
2025-01-24 16:54:03,922 - 
Epoch 94/100
2025-01-24 16:54:03,922 - Train Metrics: {'loss': 0.0465197327744473, 'recon_loss': 0.008621077197353782, 'codebook_loss': 0.03031892443785582, 'commitment_loss': 0.03031892443785582, 'perplexity': 330.2020614116698}
2025-01-24 16:54:03,923 - Test Metrics: {'test_loss': 0.047526058139680305, 'test_recon_loss': 0.009732387252623521, 'test_codebook_loss': 0.030234936695498756, 'test_commitment_loss': 0.030234936695498756, 'test_perplexity': 326.8942569780953}
2025-01-24 16:54:18,680 - 
Epoch 95/100
2025-01-24 16:54:18,680 - Train Metrics: {'loss': 0.0465489546184802, 'recon_loss': 0.008610793521575382, 'codebook_loss': 0.03035052891944528, 'commitment_loss': 0.03035052891944528, 'perplexity': 330.3265694620664}
2025-01-24 16:54:18,680 - Test Metrics: {'test_loss': 0.04666511997391906, 'test_recon_loss': 0.009799258406215075, 'test_codebook_loss': 0.029492688990091977, 'test_commitment_loss': 0.029492688990091977, 'test_perplexity': 328.3077365537233}
2025-01-24 16:54:33,462 - 
Epoch 96/100
2025-01-24 16:54:33,462 - Train Metrics: {'loss': 0.046516309842429195, 'recon_loss': 0.00858141926576948, 'codebook_loss': 0.030347912403209436, 'commitment_loss': 0.030347912403209436, 'perplexity': 330.82011355036667}
2025-01-24 16:54:33,462 - Test Metrics: {'test_loss': 0.04707995839888537, 'test_recon_loss': 0.009894001521641695, 'test_codebook_loss': 0.02974876537447489, 'test_commitment_loss': 0.02974876537447489, 'test_perplexity': 328.6574417307407}
2025-01-24 16:54:48,233 - 
Epoch 97/100
2025-01-24 16:54:48,233 - Train Metrics: {'loss': 0.04647417349354995, 'recon_loss': 0.008604378783670456, 'codebook_loss': 0.030295835736462527, 'commitment_loss': 0.030295835736462527, 'perplexity': 330.52018008024794}
2025-01-24 16:54:48,233 - Test Metrics: {'test_loss': 0.049021406500022624, 'test_recon_loss': 0.00987295920760194, 'test_codebook_loss': 0.031318757871661, 'test_commitment_loss': 0.031318757871661, 'test_perplexity': 331.6397766885878}
2025-01-24 16:55:03,006 - 
Epoch 98/100
2025-01-24 16:55:03,006 - Train Metrics: {'loss': 0.046302896316932594, 'recon_loss': 0.008580542290988176, 'codebook_loss': 0.03017788318455067, 'commitment_loss': 0.03017788318455067, 'perplexity': 330.4541943640355}
2025-01-24 16:55:03,006 - Test Metrics: {'test_loss': 0.04719288633028163, 'test_recon_loss': 0.009754453149117246, 'test_codebook_loss': 0.02995074641761146, 'test_commitment_loss': 0.02995074641761146, 'test_perplexity': 329.259250302858}
2025-01-24 16:55:17,798 - 
Epoch 99/100
2025-01-24 16:55:17,798 - Train Metrics: {'loss': 0.046337036125342866, 'recon_loss': 0.008574907458327768, 'codebook_loss': 0.030209702870729938, 'commitment_loss': 0.030209702870729938, 'perplexity': 330.8313739903443}
2025-01-24 16:55:17,798 - Test Metrics: {'test_loss': 0.047010214645651326, 'test_recon_loss': 0.009844461361630053, 'test_codebook_loss': 0.02973260256591477, 'test_commitment_loss': 0.02973260256591477, 'test_perplexity': 329.05734214299844}
2025-01-24 16:55:32,587 - 
Epoch 100/100
2025-01-24 16:55:32,588 - Train Metrics: {'loss': 0.04623389538482327, 'recon_loss': 0.008559829961565677, 'codebook_loss': 0.03013925229573189, 'commitment_loss': 0.03013925229573189, 'perplexity': 330.7531972431466}
2025-01-24 16:55:32,588 - Test Metrics: {'test_loss': 0.04803207332763491, 'test_recon_loss': 0.0097341248411921, 'test_codebook_loss': 0.030638358543945265, 'test_commitment_loss': 0.030638358543945265, 'test_perplexity': 333.92403015909315}
2025-01-24 16:55:32,593 - 
Running final comprehensive evaluation...
2025-01-24 16:55:41,390 - Final Evaluation Results: {'avg_reconstruction_loss': 0.009819779934102222, 'codebook_utilization': 0.408203125, 'perplexity': 349.11138916015625, 'avg_sample_quality': 0.010216148861451075}
2025-01-24 16:55:41,396 - Final experiment completed successfully.
